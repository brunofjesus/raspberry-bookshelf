name: Build and Release

on:
  release:
    types: [created]

jobs:
  build-and-upload:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Go
      uses: actions/setup-go@v4
      with:
        go-version: '1.25'

    - name: Install dependencies
      run: make dependencies

    - name: Build all platforms
      run: make build-all

    - name: Upload binaries to release                                                           
      uses: softprops/action-gh-release@v1                                                       
      with:                                                                                      
        files: ./bin/bookshelf*                                                                  
      env:                                                                                       
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}                                                

